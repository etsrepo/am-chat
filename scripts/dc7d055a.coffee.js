(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;e=PUBNUB.$("box"),i=PUBNUB.$("input"),k=PUBNUB.$("login"),l=PUBNUB.$("logout"),p=PUBNUB.$("time-left"),o=60,j=null,f="chat",d=PUBNUB.uuid(),m=PUBNUB.init({publish_key:"pub-c-4268517d-1e7a-4bdd-8037-090a3c76a1f0",subscribe_key:"sub-c-4c15a542-ced1-11e2-b70f-02ee2ddab7fe",auth_key:d,origin:"pam-beta.pubnub.com"}),c=!1,b=function(a){return e.innerHTML="<span class='msg'>"+(""+a).replace(/[<>]/g,"")+"</span><br>"+e.innerHTML},m.subscribe({channel:f,callback:function(a){return b(a)}}),PUBNUB.bind("keyup",i,function(a){return 13===a.keyCode||13===a.charCode?m.publish({channel:f,message:i.value,x:i.value="",error:function(a){return 403===a.status?b("[Access Denied] Please press Login to access chat"):void 0}}):void 0}),a=function(a,b){return a.className+=""+b},n=function(a,b){return a.className=a.className.replace(b,"")},m.publish({channel:"authentication",message:JSON.stringify({uuid:d,action:"presence"})}),g=function(){return k.disabled=!0,k.value="Logging In...",l.value="Logout",m.publish({channel:"authentication",message:JSON.stringify({action:"login",authKey:d})})},h=function(){return l.disabled=!0,l.value="Logging Out...",k.value="Login",m.publish({channel:"authentication",message:JSON.stringify({action:"logout",authKey:d})})},m.subscribe({channel:d,callback:function(b){var c,d;return b=JSON.parse(b),"login"===b.action?(k.disabled=!1,b.success===!0?(n(l,"hidden"),n(k,"slideUp"),a(l,"slideUp"),a(k,"hidden"),o=60,c=function(){return o--,p.innerHTML="You have "+o+" seconds left...",0===o?(h({}),clearInterval(j)):void 0},j=setInterval(c,1e3)):(k.value="Error...",d=function(){return k.value="Login"},setTimeout(d,3e3))):"logout"===b.action?(l.disabled=!1,b.success===!0?(a(k,"slideUp"),a(l,"hidden"),n(k,"hidden"),n(l,"slideUp"),clearInterval(j),p.innerHTML=""):(l.value="Error...",d=function(){return l.value="Login"},setTimeout(d,3e3))):void 0},connect:function(){return PUBNUB.bind("click",k,g),PUBNUB.bind("click",l,h)}})}).call(this);